<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>試合結果リアルタイム表示</title>
    <link href="/common/realtime_pa6.css" rel="stylesheet" type="text/css" />
</head>

<body>
    <div class="container">
        <div class="content" id="score1"></div>
        <div class="content" id="score2"></div>
        <div class="content" id="score3"></div>
        <div class="content" id="score4"></div>
        <div class="content" id="score5"></div>
        <div class="content" id="score6"></div>
        <div class="content" id="score7"></div>
        <div class="content" id="score8"></div>
        <div class="content_" id="score9"></div>
        <div class="content_" id="score10"></div>
        <div class="content_" id="score11"></div>
        <div class="content_" id="score12"></div>
        <div class="clearfloat"></div>
    </div>
</body>
<script type="text/javascript" src="/common/jquery-3.0.0.min.js"></script>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript">

    let conn = null;

    function open() {
        //conn = new WebSocket('ws://133.125.40.139:3000');
        //conn = new WebSocket('ws://127.0.0.1:3000');
        conn = new WebSocket('ws://' + base_ip + ':3000/');

        conn.onopen = function (e) {
            conn.send('{"mode":1,"navi":' + mavi_id + ',"places":["1","2","3","4","5","6"]}');
        };

        conn.onerror = function (e) {
            alert("エラーが発生しました");
        };

        conn.onmessage = function (e) {
            console.log('message');
            var data = JSON.parse(e.data);
            if (data["navi"] != mavi_id) { return; }
            if (data["place"] == 1) {
                $("#score1").html(data["html"]);
            } else if (data["place"] == 2) {
                $("#score2").html(data["html"]);
            } else if (data["place"] == 3) {
                $("#score3").html(data["html"]);
            } else if (data["place"] == 4) {
                $("#score4").html(data["html"]);
            } else if (data["place"] == 5) {
                $("#score5").html(data["html"]);
            } else if (data["place"] == 6) {
                $("#score6").html(data["html"]);
            } else if (data["place"] == 7) {
                $("#score7").html(data["html"]);
            } else if (data["place"] == 8) {
                $("#score8").html(data["html"]);
            } else if (data["place"] == 9) {
                $("#score9").html(data["html"]);
            } else if (data["place"] == 10) {
                $("#score10").html(data["html"]);
            } else if (data["place"] == 11) {
                $("#score11").html(data["html"]);
            } else if (data["place"] == 12) {
                $("#score12").html(data["html"]);
            }
        };

        conn.onclose = function () {
            alert("切断しました");
            setTimeout(open, 5000);
        };
    }

    open();
</script>

<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-67305136-4', 'auto');
    ga('send', 'pageview');
</script>

</html>